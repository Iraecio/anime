<!-- Header Navigation -->
<header class="header-navbar bg-dark border-bottom border-secondary position-sticky top-0" style="z-index: 1000;">
  <div class="container-fluid">
    <div class="row align-items-center py-3">
      <!-- Logo/Brand -->
      <div class="col-auto">
        <h1 class="h3 mb-0 text-white fw-bold">
          <!-- Logo completo para telas grandes (md e acima) -->
          <span class="d-none d-md-inline">
            <span class="text-danger">Animes</span> BR
          </span>
          <!-- Logo compacto para telas pequenas (sm e abaixo) -->
          <span class="d-inline d-md-none">
            <span class="text-danger">A</span>BR
          </span>
        </h1>
      </div>

      <!-- Search Bar (centered) -->
      <div class="col">
        <div class="d-flex justify-content-center">
          <div class="search-wrapper" style="width: 100%;">
            <app-search [config]="searchConfig" [isSearching]="isSearching()" [initialQuery]="searchQuery()"
              (onSearch)="handleSearch($event)" (onClear)="handleSearchClear()"></app-search>
          </div>
        </div>
      </div>
    </div>

    <!-- Cache Debug Component (only in development) -->
    @if (showCacheDebug()) {
    <div class="row">
      <div class="col-12">
        <app-cache-debug></app-cache-debug>
      </div>
    </div>
    }
  </div>
</header>

<div class="container-fluid bg-dark text-white min-vh-100 py-4" style="padding-top: 2rem !important;">

  <!-- Grid de animes -->
  <div class="row">
    @if (showDataLoading()) {
    <div class="col-12">
      <div class="d-flex flex-column align-items-center justify-content-center py-5">
        <div class="spinner-border text-primary mb-3" style="width: 3rem; height: 3rem;" role="status">
          <span class="visually-hidden">Carregando...</span>
        </div>
        <p class="h5 text-muted">{{ isInSearchMode() ? 'Buscando' : 'Carregando' }} animes...</p>
      </div>
    </div>
    } @else if (animes().length === 0 && isInSearchMode()) {
    <div class="col-12">
      <div class="text-center py-5">
        <div class="display-1 mb-4">üîç</div>
        <h3 class="h2 mb-3">Nenhum anime encontrado</h3>
        <p class="lead text-muted mb-4">N√£o encontramos animes com o termo "<span class="text-info">{{ searchQuery()
            }}</span>"</p>
        <button class="btn btn-primary btn-lg" (click)="handleSearchClear()">
          ‚Üê Ver todos os animes
        </button>
      </div>
    </div>
    } @else {
    @if (recentAnimes().length > 0) {
    <div class="mb-4">
      <app-anime-row title="Rec√©m Adicionados" [animes]="recentAnimes()" [showTitle]="true"
        (onAnimeClick)="handleAnimeCardClick($event)" (onEpisodeClick)="handleEpisodeClick($event)"
        (onAdultContentToggle)="handleAdultContentToggle($event)">
      </app-anime-row>
    </div>
    }
    @for (anime of animes(); track anime.id; let i = $index) {
    <div class="col-12 col-sm-4 col-md-3 col-lg-2 col-xl-2 mb-4">
      <app-card-anime [anime]="anime" [index]="i" (onCardClick)="handleAnimeCardClick($event)"
        (onEpisodeClick)="handleEpisodeClick($event)"
        (onAdultContentToggle)="handleAdultContentToggle($event)"></app-card-anime>
    </div>
    }
    }

    <!-- Pagina√ß√£o -->
    <div class="d-flex flex-column align-items-center gap-3 mt-5">
      <app-paginacao [totalItems]="totalAnimes()" [itemsPerPage]="perPage()" [currentPage]="currentPage()"
        (onPageChange)="handlePageChange($event)"></app-paginacao>
    </div>
  </div>